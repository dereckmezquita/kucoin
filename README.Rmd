---
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    warning = FALSE,
    message = FALSE,
    fig.path = "man/figures/README-",
    fig.align = "center",
    out.width = "100%",
    collapse = TRUE,
    comment = "#>"
)

options("datatable.print.topn" = 3, "datatable.print.nrows" = 50, "datatable.print.class" = TRUE, "datatable.print.trunc.cols" = TRUE)
```

# kucoin

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/dereckdemezquita/kucoin.svg?branch=master)](https://travis-ci.org/dereckdemezquita/kucoin)
<!-- badges: end -->

## Installation

You can install the development version of `kucoin` using:

```{r, eval=FALSE}
# install.packages("remotes")
remotes::install_github("dereckdemezquita/kucoin")
```

## Getting Started

For more details and tutorials see the documentation at [TUTORIALS](TUTORIALS.md).

```{r}
# import library
library("kucoin")
```

### API Authorisation

Some functions in this package require permissioned access and need a proper API key, secret, and passphrase. If you don't have a key, or need more information, visit the [Generating an API Key](https://docs.kucoin.com/#generating-an-api-key){target="_blank}.

Current functions that need API authorisation are:

* `kucoin::cancel_all_orders`
* `kucoin::cancel_order`
* `kucoin::get_orders_all`
* `kucoin::get_account_balances`
* `kucoin::get_deposit_address`
* `kucoin::get_orders_by_id`
* `kucoin::submit_limit_order`
* `kucoin::submit_market_order`

#### Setting-up API Key

Use an `.Renviron` file to set your API key. You can `touch` or use `usethat` to create a new `.Renviron` file; [`usethis::edit_r_environ()`](https://usethis.r-lib.org/reference/edit.html){target="_blank"}:

In the `.Renviron` file, insert your API key details as follow:

```bash
KC-API-ENDPOINT = https://openapi-sandbox.kucoin.com

KC-API-KEY = XXXXXXXXXX
KC-API-SECRET = XXXXXXXXXX
KC-API-PASSPHRASE = XXXXXXXXXX
```

The `KC-API-ENDPOINT` variable is optional. This is used to allow the user access KuCoin's sandbox API for paper trading. If not set then the real API is used by default:

1. https://openapi-sandbox.kucoin.com
1. https://api.kucoin.com/

### Market Data

**All market data is publicly accessible, and could be accessed without API authorisation.**

For getting historical data, you can use `kucoin::get_market_data()`:

```{r}
# get one pair of symbol prices
prices <- kucoin::get_market_data(
    symbols = "KCS/USDT",
    from = "2022-10-05 00:00:00",
    to = "2022-11-06 00:00:00",
    frequency = "1 hour"
)

prices
```

The `kucoin::get_market_data()` function also supports for querying multiple symbols:

```{r}
# get one pair of symbol prices
prices <- kucoin::get_market_data(
    symbols = c("KCS/USDT", "BTC/USDT", "KCS/BTC"),
    from = "2022-10-05 00:00:00",
    to = "2022-11-06 00:00:00",
    frequency = "1 hour"
)

prices
```

You can also get the most recent metadata for all symbols using `kucoin::get_market_metadata()`:

```{r}
# get all symbols' most recent metadata
metadata <- kucoin::get_market_metadata()

metadata
```

### Get User Information

**All user information data is private, and needs API authorisation.**

To get balance information you can use `kucoin::get_account_balances()`:

```{r, eval=FALSE}
# get user's balance details
balances <- kucoin::get_account_balances()

balances
```

### Post an Order

**All order posting functions are private, and need API authorisation.**

#### Market Order

Here is an example of posting a market order:

```{r, eval=FALSE}
# post a market order: buy 1 KCS
order_id <- kucoin::submit_market_order(
    symbol = "KCS/BTC",
    side = "buy",
    base_size = 1
)

order_id
```

#### Limit Order

Here is an example of posting a limit order:

```{r, eval=FALSE}
# post a limit order: buy 1 KCS
order_id <- submit_limit_order(
    symbol = "KCS/BTC",
    side = "buy",
    base_size = 1
)

order_id
```

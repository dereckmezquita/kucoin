% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impl_spottrading_market_data.R
\name{get_full_orderbook_impl}
\alias{get_full_orderbook_impl}
\title{Get Full OrderBook (Implementation, Authenticated)}
\usage{
get_full_orderbook_impl(
  keys = get_api_keys(),
  base_url = get_base_url(),
  symbol,
  .__coro_env_parent__ = <environment>
)
}
\arguments{
\item{keys}{List; API configuration parameters from \code{get_api_keys()}, including:
\itemize{
\item \code{api_key} (character): KuCoin API key.
\item \code{api_secret} (character): KuCoin API secret.
\item \code{api_passphrase} (character): KuCoin API passphrase.
\item \code{key_version} (character): API key version (e.g., \code{"2"}).
Defaults to \code{get_api_keys()}.
}}

\item{base_url}{Character string; base URL for the KuCoin API. Defaults to \code{get_base_url()}.}

\item{symbol}{Character string; trading symbol (e.g., \code{"BTC-USDT"}).}
}
\value{
Promise resolving to a \code{data.table} containing:
\itemize{
\item \code{timestamp} (POSIXct): Snapshot timestamp in UTC.
\item \code{time_ms} (integer): Snapshot timestamp in milliseconds.
\item \code{sequence} (character): Orderbook update sequence.
\item \code{side} (character): Order side (\code{"bid"} or \code{"ask"}).
\item \code{price} (character): Aggregated price level.
\item \code{size} (character): Aggregated size at that price.
}
}
\description{
Retrieves the full orderbook depth data for a specified trading symbol from the KuCoin API asynchronously, requiring authentication.
}
\details{
\subsection{Workflow Overview}{
\enumerate{
\item \strong{Header Preparation}: Constructs authentication headers with \code{build_headers()} using \code{keys}.
\item \strong{Query Construction}: Builds a query string with the \code{symbol} parameter using \code{build_query()}.
\item \strong{URL Assembly}: Combines \code{base_url}, \verb{/api/v3/market/orderbook/level2}, and the query string.
\item \strong{HTTP Request}: Sends a GET request with headers and a 10-second timeout via \code{httr::GET()}.
\item \strong{Response Processing}: Validates the response with \code{process_kucoin_response()} and extracts \code{"data"}.
\item \strong{Data Conversion}: Converts bids and asks into \code{data.table}s, adds \code{side}, combines them, and appends snapshot fields.
}
}

\subsection{API Endpoint}{

\verb{GET https://api.kucoin.com/api/v3/market/orderbook/level2}
}

\subsection{Usage}{

Utilised to fetch the complete orderbook for a trading symbol, requiring API authentication for detailed depth data.
}

\subsection{Official Documentation}{

\href{https://www.kucoin.com/docs-new/rest/spot-trading/market-data/get-full-orderbook}{KuCoin Get Full OrderBook}
}
}
\examples{
\dontrun{
main_async <- coro::async(function() {
  keys <- get_api_keys()
  orderbook <- await(get_full_orderbook_impl(keys = keys, symbol = "BTC-USDT"))
  print(orderbook)
})
main_async()
while (!later::loop_empty()) later::run_now()
}
}

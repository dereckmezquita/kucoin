% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impl_market_data.R
\name{get_trade_history_impl}
\alias{get_trade_history_impl}
\title{Get Trade History (Implementation)}
\usage{
get_trade_history_impl(
  base_url = get_base_url(),
  symbol,
  .__coro_env_parent__ = <environment>
)
}
\arguments{
\item{base_url}{A character string representing the base URL for the KuCoin API.
Defaults to the value returned by \code{get_base_url()}.}

\item{symbol}{A character string representing the trading symbol (e.g., "BTC-USDT").}
}
\value{
A promise that resolves to a \code{data.table} containing the trade history records.
The data.table includes the following columns:
\describe{
\item{sequence}{(string) The sequence number for the trade.}
\item{price}{(string) The filled price of the trade.}
\item{size}{(string) The filled amount for the trade.}
\item{side}{(string) The side of the trade ("buy" or "sell").}
\item{time}{(integer) The original trade timestamp in nanoseconds.}
\item{datetime}{(POSIXct) The trade timestamp converted to a datetime (UTC).}
}
}
\description{
This asynchronous function retrieves the trade history for a specified trading symbol from the KuCoin API.
The endpoint returns the most recent 100 trade records, with each record including details such as the sequence number,
filled price, filled size, trade side (buy/sell), and the timestamp (in nanoseconds).
}
\details{
\strong{Workflow Overview:}
\enumerate{
\item \strong{Query String Construction:}
Uses the helper function \code{build_query()} to construct a query string containing the required \code{symbol} parameter.
\item \strong{URL Construction:}
Constructs the full URL by concatenating the base URL (obtained via \code{get_base_url()}), the endpoint path
\code{/api/v1/market/histories}, and the query string.
\item \strong{HTTP Request:}
Sends a GET request to the constructed URL using \code{httr::GET()} with a 10â€‘second timeout.
\item \strong{Response Processing:}
Processes the response using \code{process_kucoin_response()} to validate the HTTP status and API code,
then extracts the \code{data} field which contains an array of trade history objects.
\item \strong{Data Conversion:}
Converts the array of trade history objects into a \code{data.table}.
\item \strong{Timestamp Conversion:}
Converts the trade timestamp from nanoseconds to a POSIXct datetime by dividing by 1e6 (to get milliseconds)
and applying the helper function \code{time_convert_from_kucoin("ns")}.
}

\strong{API Documentation:}
\href{https://www.kucoin.com/docs-new/rest/spot-trading/market-data/get-trade-history}{KuCoin Get Trade History}

\strong{Endpoint:} \code{GET https://api.kucoin.com/api/v1/market/histories?symbol=<symbol>}

This function uses a public API endpoint and does not require authentication.
}
\examples{
\dontrun{
  # Retrieve the trade history for the BTC-USDT trading pair:
  dt_trade_history <- await(market_data$get_trade_history(symbol = "BTC-USDT"))
  print(dt_trade_history)
}

}
